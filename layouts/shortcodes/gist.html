{{- $urlPre := "https://api.github.com" -}}
{{- $userName := .Get "user" | default "loikein" -}}
{{- $gistID := .Get "gist" -}}
{{- $fileName := .Get "file" -}}
{{- $gistJSON := getJSON $urlPre "/gists/" $gistID -}}
{{/*

 https://discourse.gohugo.io/t/accessing-json-data-files-with-extra-dots-in-file-names/15498/7

*/}}
{{- with .Parent -}}
  {{- range $key, $value := $gistJSON.files -}}
  {{- if (eq $key $fileName) -}}
  {{- printf "%s" $key }}

  {{- printf "%s" $value.content | htmlUnescape | safeHTML -}}
  {{- end -}}
  {{- end -}}
{{- else -}}
<script type="application/javascript" src="https://gist.github.com/{{ $userName }}/{{ $gistID }}.js?file={{ $fileName }}"></script>
{{- end -}}
